// 阿里面试题
function Dog(name) {
  this.name = name;
}
Dog.prototype.bark = function () {
  console.log("wangwang");
};
Dog.prototype.sayName = function () {
  console.log("my name is" + this.name);
};
/*
 *@params Func: 即将创建的类
 *@params args: 给当前这个类执行时候传递的实参
 * new: 1. 作为普通函数执行；
 *      2. 创建一个实例对象（-> 1. 空对象 -> 2. 对象.__proto__ === 类.prototype）
 *      3. 方法执行的时候，方法中的this指向当前实例对象
 *      4. 判断方法的返回结果，如果返回的不是引用类型值，默认把实例返回
 * Object.create(xxx)： 创建一个空对象，并且把xxx作为创建对象的原型(简单说,空对象.__proto__ = xxx)
 * 需要注意的是，xxx必须是对象或者null, 如果xxx是null，则会创建一个没有任何原型指向的空对象
 *
 * 处理Object.create()兼容
 *
 */
Object.create = function (prototype) {
  // 不考虑null的情况
  function Fn() {}
  Fn.prototype = prototype;
  return new Fn();
};

function _new(Func, ...args) {
  // let obj = {};
  // obj.__proto__ = Func.prototype
  let obj = Object.create(Func.prototype);
  let result = Func.call(obj, ...args);
  if (
    result == null ||
    !/^(object|                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           $/.test(
      typeof result
    )
  )
    return obj; // 如果不是引用类型,则返回当前实例对象
  return result; // 如果是引用类型的值，直接返回即可
}

let sanmao = _new(Dog, "三毛");
sanmao.bark();
sanmao.sayName();
console.log(sanmao instanceof Dog);
